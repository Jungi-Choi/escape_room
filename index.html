<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•œêµ­ì¸ë§Œ íƒˆì¶œ ê°€ëŠ¥í•œ ë°©íƒˆì¶œ ê²Œì„</title>
    <style>
        /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            background-color: #000;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        h1, h2 {
            color: #ffc107;
            text-shadow: 2px 2px 4px #000;
        }

        button {
            cursor: pointer;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            transition: transform 0.2s, background-color 0.2s;
        }
        button:hover:not(:disabled) {
            transform: scale(1.05);
        }

        /* ì‹œì‘ í™”ë©´ */
        #start-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px;
        }
        #start-screen h1 { font-size: 3em; }
        #best-record-display { margin: 20px 0; font-size: 1.2em; color: #00bcd4; }
        #start-button {
            padding: 15px 30px;
            font-size: 1.5em;
            background: linear-gradient(45deg, #ffc107, #ff9800);
            color: #000;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        /* ê²Œì„ ì»¨í…Œì´ë„ˆ */
        #game-container {
            position: relative;
            width: 900px;
            max-width: 95%;
            border: 2px solid #fff;
            background-color: #000;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
            text-align: center;
            display: none; /* ì´ˆê¸°ì—ëŠ” ìˆ¨ê¹€ */
        }

        /* ìƒë‹¨ ë°” (ì¢Œ: í‹€ë¦°íšŸìˆ˜, ìš°: íƒ€ì´ë¨¸, ë‹¨ì„œ) */
        #wrong-answer-counter {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 1.2em;
            font-weight: bold;
            color: #ff6b6b;
            background-color: rgba(0,0,0,0.7);
            padding: 5px 10px;
            border-radius: 5px;
            z-index: 10;
        }
        #top-bar {
            position: absolute;
            top: 15px;
            right: 20px;
            display: flex;
            gap: 15px;
            align-items: center;
            z-index: 10;
        }
        #timer {
            font-size: 1.5em;
            font-weight: bold;
            color: #ff4545;
            background-color: rgba(0,0,0,0.7);
            padding: 5px 10px;
            border-radius: 5px;
        }
        #era-clue-button {
            padding: 8px 15px;
            font-size: 0.9em;
            background-color: #00bcd4;
            color: white;
        }
        #era-clue-button:disabled { background-color: #555; cursor: not-allowed; }

        /* ë°© í™”ë©´ */
        #room-screen { position: relative; width: 100%; padding-top: 66.66%; }
        #room-image { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }

        /* í´ë¦­ ê°€ëŠ¥í•œ ì˜¤ë¸Œì íŠ¸ */
        .clickable-object {
            position: absolute;
            background-color: rgba(255, 255, 0, 0.2);
            border: 2px dashed yellow;
            cursor: pointer;
            transition: background-color 0.3s, border 0.3s;
        }
        .clickable-object:hover { background-color: rgba(255, 0, 0, 0.4); border: 2px solid red; }
        .clickable-object.solved { background-color: rgba(0, 255, 0, 0.3); border: 2px solid limegreen; cursor: not-allowed; }

        /* ì»¨íŠ¸ë¡¤ íŒ¨ë„ */
        #controls { padding: 20px; background-color: #222; }
        #hints-list { list-style-type: 'ğŸ’¡ '; padding-left: 20px; text-align: left; min-height: 50px; }
        #password-form { display: flex; justify-content: center; gap: 10px; margin-top: 15px; }
        #password-input { padding: 10px; font-size: 1em; width: 200px; border-radius: 5px; border: 1px solid #ccc; }
        #password-submit { padding: 10px 20px; font-size: 1em; background-color: #ffc107; color: #000; }
        
        /* ë°© ì „í™˜ ì• ë‹ˆë©”ì´ì…˜ ì˜¤ë²„ë ˆì´ */
        #transition-overlay {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background-color: #000; opacity: 0; z-index: 999;
            pointer-events: none; transition: opacity 0.5s ease-in-out;
        }
        #transition-overlay.active { opacity: 1; }

        /* ê²Œì„ ì˜¤ë²„ í™”ë©´ ìŠ¤íƒ€ì¼ */
        #game-over-screen {
            display: none; /* ì´ˆê¸°ì—ëŠ” ìˆ¨ê¹€ */
            position: fixed;
            top: 0; left: 0; width: 100vw; height: 100vh;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
        }
        #game-over-screen img {
            max-width: 80%;
            max-height: 50vh;
            border-radius: 10px;
            border: 2px solid #ffc107;
        }
        #game-over-screen p {
            font-size: 1.5em;
            color: #ff6b6b;
            margin: 20px 0;
            font-weight: bold;
        }
        #restart-from-game-over {
            padding: 10px 25px;
            font-size: 1.2em;
            background-color: #00bcd4;
            color: white;
        }
    </style>
</head>
<body>

    <!-- ì‹œì‘ í™”ë©´ -->
    <div id="start-screen">
        <h1>í•œêµ­ì¸ë§Œ íƒˆì¶œ ê°€ëŠ¥í•œ ë°©íƒˆì¶œ</h1>
        <div id="best-record-display">
            <h2>ìµœê³  ê¸°ë¡</h2>
            <p id="record-text">ì•„ì§ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>
        </div>
        <button id="start-button">ê²Œì„ ì‹œì‘</button>
    </div>

    <!-- ê²Œì„ ì»¨í…Œì´ë„ˆ -->
    <div id="game-container">
        <div id="wrong-answer-counter"></div>
        <div id="top-bar">
            <div id="timer">00:00</div>
            <button id="era-clue-button"></button>
        </div>
        <h1 id="room-title"></h1>
        <div id="room-screen">
            <img id="room-image" src="" alt="ë°© ì´ë¯¸ì§€">
            <div id="objects-container"></div>
        </div>
        <div id="controls">
            <h2>íšë“í•œ íŒíŠ¸</h2>
            <ul id="hints-list"></ul>
            <div id="password-form">
                <input type="text" id="password-input" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                <button id="password-submit">íƒˆì¶œ ì‹œë„</button>
            </div>
        </div>
    </div>

    <!-- ë°© ì „í™˜ ì• ë‹ˆë©”ì´ì…˜ìš© ì˜¤ë²„ë ˆì´ -->
    <div id="transition-overlay"></div>

    <!-- ê²Œì„ ì˜¤ë²„ í™”ë©´ -->
    <div id="game-over-screen">
        <img src="https://github.com/Jungi-Choi/escape_room/blob/main/%E1%84%82%E1%85%A1%E1%84%85%E1%85%B3%E1%86%AF%20%E1%84%80%E1%85%A1%E1%84%85%E1%85%B5%E1%84%8F%E1%85%B5%E1%86%B7.jpeg?raw=true" alt="ê²Œì„ ì˜¤ë²„ ì´ë¯¸ì§€">
        <p>ë‹¹ì‹ ì€ ì´ ë°©ì„ í‰ìƒ íƒˆì¶œ ëª» í• ê²ƒ ê°™ìŠµë‹ˆë‹¤. ì—­ì‚¬ ê³µë¶€ë‚˜ í•˜ì„¸ìš”. :)</p>
        <button id="restart-from-game-over">ì²˜ìŒìœ¼ë¡œ</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const gameData = [
                {
                    name: '3.1ìš´ë™',
                    image: 'https://github.com/Jungi-Choi/escape_room/blob/main/%E1%84%83%E1%85%A9%E1%86%A8%E1%84%85%E1%85%B5%E1%86%B8%E1%84%8B%E1%85%AE%E1%86%AB%E1%84%83%E1%85%A9%E1%86%BC.jpg?raw=true',
                    password: '1919ë…ë¦½',
                    objects: [ { id: 'obj1', pos: { top: '50%', left: '25%', width: '7%', height: '10%' }, puzzle: 'ì´ ì¢…ì´ì˜ ì´ë¦„ì€ ë¬´ì—‡ì¼ê¹Œìš”? (ì´ˆì„±íŒíŠ¸: ã„·ã„¹ã……ã…‡ã……)', answer: 'ë…ë¦½ì„ ì–¸ì„œ', hint: 'ì´ ë°©ì˜ ë¹„ë°€ë²ˆí˜¸ì™€ëŠ” ì§ì ‘ì ì¸ ê´€ë ¨ì´ ì—†ëŠ” ë‹¨ì„œì´ë‹¤.', validation: { type: 'length', value: 5 } } ],
                    eraPuzzles: [ { id: 'era1', puzzle: '3.1ìš´ë™ì´ ì¼ì–´ë‚œ ì—°ë„ëŠ”? (ìˆ«ì 4ìë¦¬)', answer: '1919', hint: "ë¹„ë°€ë²ˆí˜¸ì˜ ì• 4ìë¦¬ëŠ” [ 1919 ] ì´ë‹¤.", validation: { type: 'regex', value: /^\d{4}$/ } }, { id: 'era2', puzzle: '3.1ìš´ë™ì˜ ëª©ì ì€ ë¬´ì—‡ì¼ê¹Œìš”? (ì¡°ì„ ì˜ OO)', answer: 'ë…ë¦½', hint: "ë¹„ë°€ë²ˆí˜¸ì˜ ë’¤ 2ê¸€ìëŠ” [ ë…ë¦½ ] ì´ë‹¤.", validation: { type: 'length', value: 2 } } ]
                },
                {
                    name: 'ë‘ ë²ˆì§¸ ë°©: ê³ êµ¬ë ¤ì˜ ê¸°ìƒ',
                    image: 'https://github.com/Jungi-Choi/escape_room/blob/main/%E1%84%89%E1%85%AE%E1%84%85%E1%85%A7%E1%86%B8%E1%84%83%E1%85%A9.jpg?raw=true',
                    password: '391',
                    objects: [ { id: 'obj1', pos: { top: '30%', left: '5%', width: '30%', height: '50%' }, puzzle: "ê³ êµ¬ë ¤ ì—­ì‚¬ìƒ ê°€ì¥ ë„“ì€ ì˜í† ë¥¼ ì°¨ì§€í–ˆë˜ ì™•ì˜ ì´ë¦„ì€ 'ê´‘ê°œí† ëŒ€ì™•'ì…ë‹ˆë‹¤. ê·¸ì˜ ì´ë¦„ì—ì„œ ìˆ«ì 3ì— í•´ë‹¹í•˜ëŠ” ê¸€ìëŠ” ë¬´ì—‡ì¼ê¹Œìš”?", answer: 'ê´‘', hint: "ë¹„ë°€ë²ˆí˜¸ì˜ ì²« ë²ˆì§¸ ìˆ«ìëŠ” [ 3 ] ì´ë‹¤." }, { id: 'obj2', pos: { top: '55%', left: '60%', width: '25%', height: '30%' }, puzzle: "ê´‘ê°œí† ëŒ€ì™•ì˜ ì•„ë“¤ë¡œ, ì•„ë²„ì§€ì˜ ì—…ì ì„ ê¸°ë¦¬ëŠ” ë¹„ì„ì„ ì„¸ìš´ ì™•ì€ ëˆ„êµ¬ì¼ê¹Œìš”?", answer: 'ì¥ìˆ˜ì™•', hint: "ì¥ìˆ˜ì™•ì´ ì™•ìœ„ì— ìˆì—ˆë˜ ê¸°ê°„(79ë…„)ì—ì„œ 70ì„ ë¹¼ë©´? ë¹„ë°€ë²ˆí˜¸ì˜ ë‘ ë²ˆì§¸ ìˆ«ìëŠ” [ 9 ] ì´ë‹¤." } ],
                    eraPuzzles: [ { id: 'era1', puzzle: "ê´‘ê°œí† ëŒ€ì™•ì´ ì™•ìœ„ì— ì˜¤ë¥¸ í•´ëŠ” ëª‡ ë…„ì¼ê¹Œìš”?", answer: '391', hint: "ë¹„ë°€ë²ˆí˜¸ì˜ ì„¸ ë²ˆì§¸ ìˆ«ìëŠ” [ 1 ] ì´ë‹¤." } ]
                },
                {
                    name: 'ì„¸ ë²ˆì§¸ ë°©: ê³¼í•™ì˜ ë°œì „',
                    image: 'https://github.com/Jungi-Choi/escape_room/blob/main/%E1%84%8E%E1%85%B3%E1%86%A8%E1%84%8B%E1%85%AE%E1%84%80%E1%85%B5.png?raw=true',
                    password: '1443',
                    objects: [ { id: 'obj1', pos: { top: '20%', left: '30%', width: '40%', height: '60%' }, puzzle: "ì‚¬ì§„ ì† 'ì¸¡ìš°ê¸°'ê°€ ë°œëª…ëœ ì—°ë„ì˜ ì• ë‘ ìë¦¬ëŠ” ë¬´ì—‡ì¼ê¹Œìš”?", answer: '14', hint: "ë¹„ë°€ë²ˆí˜¸ì˜ ì• ë‘ ìë¦¬ëŠ” [ 14 ] ì´ë‹¤." }, { id: 'obj2', pos: { top: '5%', left: '5%', width: '20%', height: '30%' }, puzzle: "ì„¸ì¢…ëŒ€ì™•ì´ í•œê¸€ì„ ë°˜í¬í•œ í•´ëŠ” 1446ë…„ì…ë‹ˆë‹¤. ì¸¡ìš°ê¸°ê°€ ë°œëª…ëœ í•´(1441ë…„)ì™€ ëª‡ ë…„ ì°¨ì´ê°€ ë‚ ê¹Œìš”?", answer: '5', hint: "ë¹„ë°€ë²ˆí˜¸ì˜ ì„¸ ë²ˆì§¸ ìˆ«ìëŠ” [ 4 ]ì´ë‹¤. (5-1)" } ],
                    eraPuzzles: [ { id: 'era1', puzzle: "ì„¸ì¢…ëŒ€ì™• ì‹œëŒ€ì˜ ë˜ ë‹¤ë¥¸ ìœ„ëŒ€í•œ ê³¼í•™ ë°œëª…í’ˆìœ¼ë¡œ, ìŠ¤ìŠ¤ë¡œ ì‹œê°„ì„ ì•Œë ¤ì£¼ëŠ” ë¬¼ì‹œê³„ì˜ ì´ë¦„ì€ ë¬´ì—‡ì¼ê¹Œìš”?", answer: 'ìê²©ë£¨', hint: "ì„¸ì¢…ëŒ€ì™•ì´ í›ˆë¯¼ì •ìŒì„ ì°½ì œí•œ í•´ëŠ” 144[ 3 ]ë…„ì´ë‹¤." } ]
                }
            ];

            // DOM ìš”ì†Œ
            const startScreen = document.getElementById('start-screen');
            const gameContainer = document.getElementById('game-container');
            const startButton = document.getElementById('start-button');
            const recordText = document.getElementById('record-text');
            const roomTitle = document.getElementById('room-title');
            const roomImage = document.getElementById('room-image');
            const objectsContainer = document.getElementById('objects-container');
            const hintsList = document.getElementById('hints-list');
            const passwordInput = document.getElementById('password-input');
            const passwordSubmit = document.getElementById('password-submit');
            const eraClueButton = document.getElementById('era-clue-button');
            const timerDisplay = document.getElementById('timer');
            const transitionOverlay = document.getElementById('transition-overlay');
            const wrongAnswerCounter = document.getElementById('wrong-answer-counter');
            const gameOverScreen = document.getElementById('game-over-screen');
            const restartFromGameOverButton = document.getElementById('restart-from-game-over');

            // ê²Œì„ ìƒíƒœ ë³€ìˆ˜
            let currentRoomIndex = 0;
            let solvedPuzzles = [];
            let timerInterval;
            let elapsedSeconds = 0;
            let bestRecord = JSON.parse(localStorage.getItem('bestRecord')) || { name: null, time: Infinity };
            let wrongAnswerCount = 0;
            const MAX_WRONG_ANSWERS = 4;

            // --- ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ---
            const formatTime = (seconds) => {
                const mins = Math.floor(seconds / 60).toString().padStart(2, '0');
                const secs = (seconds % 60).toString().padStart(2, '0');
                return `${mins}:${secs}`;
            };

            const updateBestRecordDisplay = () => {
                if (bestRecord.name) {
                    recordText.textContent = `${bestRecord.name} - ${formatTime(bestRecord.time)}`;
                } else {
                    recordText.textContent = 'ì•„ì§ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.';
                }
            };

            const getValidatedInput = (puzzle, validation) => {
                let userAnswer;
                while (true) {
                    userAnswer = prompt(puzzle);
                    if (userAnswer === null) return null;
                    let isValid = true;
                    let errorMsg = '';
                    if (validation) {
                        if (validation.type === 'length' && userAnswer.length !== validation.value) {
                            isValid = false;
                            errorMsg = `${validation.value}ê¸€ìë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.`;
                        } else if (validation.type === 'regex' && !validation.value.test(userAnswer)) {
                            isValid = false;
                            errorMsg = 'í˜•ì‹ì— ë§ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”. (ì˜ˆ: 4ìë¦¬ ìˆ«ì)';
                        }
                    }
                    if (isValid) return userAnswer;
                    alert(errorMsg);
                }
            };

            const updateEraClueButtonState = () => {
                const room = gameData[currentRoomIndex];
                const remainingClues = room.eraPuzzles.filter(p => !solvedPuzzles.includes(p.id)).length;
                eraClueButton.textContent = `ë‹¨ì„œ (${remainingClues})`;
                eraClueButton.disabled = (remainingClues === 0);
            };

            const updateWrongAnswerDisplay = () => {
                wrongAnswerCounter.textContent = `í‹€ë¦° íšŸìˆ˜: ${wrongAnswerCount} / ${MAX_WRONG_ANSWERS}`;
            };

            // --- íƒ€ì´ë¨¸ í•¨ìˆ˜ ---
            const startTimer = () => {
                elapsedSeconds = 0;
                timerDisplay.textContent = formatTime(elapsedSeconds);
                timerInterval = setInterval(() => {
                    elapsedSeconds++;
                    timerDisplay.textContent = formatTime(elapsedSeconds);
                }, 1000);
            };

            const stopTimer = () => clearInterval(timerInterval);

            // --- ê²Œì„ íë¦„ í•¨ìˆ˜ ---
            const startGame = () => {
                startScreen.style.display = 'none';
                gameContainer.style.display = 'block';
                currentRoomIndex = 0;
                wrongAnswerCount = 0;
                updateWrongAnswerDisplay();
                startTimer();
                loadRoom(currentRoomIndex);
            };

            const endGame = () => {
                stopTimer();
                alert(`íƒˆì¶œ ì„±ê³µ! ê¸°ë¡: ${formatTime(elapsedSeconds)}`);
                if (elapsedSeconds < bestRecord.time) {
                    const name = prompt(`ìµœê³  ê¸°ë¡ ê°±ì‹ ! ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”:`);
                    if (name) {
                        bestRecord = { name, time: elapsedSeconds };
                        localStorage.setItem('bestRecord', JSON.stringify(bestRecord));
                        alert(`${name}ë‹˜ì˜ ìƒˆë¡œìš´ ìµœê³  ê¸°ë¡ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!`);
                    }
                }
                gameContainer.style.display = 'none';
                startScreen.style.display = 'flex';
                updateBestRecordDisplay();
            };

            const triggerGameOver = () => {
                stopTimer();
                gameContainer.style.display = 'none';
                gameOverScreen.style.display = 'flex';
            };

            const loadRoom = (roomIndex) => {
                hintsList.innerHTML = '';
                objectsContainer.innerHTML = '';
                passwordInput.value = '';
                solvedPuzzles = [];
                const room = gameData[roomIndex];
                roomTitle.textContent = room.name;
                roomImage.src = room.image;
                updateEraClueButtonState();
                room.objects.forEach(obj => {
                    const objElement = document.createElement('div');
                    objElement.className = 'clickable-object';
                    Object.assign(objElement.style, obj.pos);
                    objElement.addEventListener('click', () => handleObjectClick(obj));
                    objectsContainer.appendChild(objElement);
                    obj.element = objElement;
                });
            };
            
            const transitionToNextRoom = () => {
                transitionOverlay.classList.add('active');
                setTimeout(() => {
                    currentRoomIndex++;
                    loadRoom(currentRoomIndex);
                    transitionOverlay.classList.remove('active');
                }, 600);
            };

            // --- ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ---
            const handlePuzzleSolved = (puzzle) => {
                alert('ì •ë‹µì…ë‹ˆë‹¤! íŒíŠ¸ë¥¼ íšë“í–ˆìŠµë‹ˆë‹¤.');
                const hintElement = document.createElement('li');
                hintElement.textContent = puzzle.hint;
                hintsList.appendChild(hintElement);
                solvedPuzzles.push(puzzle.id);
            };

            const handleWrongAnswer = () => {
                wrongAnswerCount++;
                updateWrongAnswerDisplay();
                if (wrongAnswerCount >= MAX_WRONG_ANSWERS) {
                    setTimeout(triggerGameOver, 100);
                } else {
                    alert('ì˜¤ë‹µì…ë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ë³´ì„¸ìš”.');
                }
            };

            const handleObjectClick = (obj) => {
                if (solvedPuzzles.includes(obj.id)) {
                    alert('ì´ë¯¸ í•´ê²°í•œ ë¬¸ì œì…ë‹ˆë‹¤.');
                    return;
                }
                const userAnswer = getValidatedInput(obj.puzzle, obj.validation);
                if (userAnswer === null) return;

                if (userAnswer.toLowerCase().trim() === obj.answer.toLowerCase().trim()) {
                    handlePuzzleSolved(obj);
                    obj.element.classList.add('solved');
                } else {
                    handleWrongAnswer();
                }
            };
            
            const handleEraClueClick = () => {
                const room = gameData[currentRoomIndex];
                const unsolvedPuzzle = room.eraPuzzles.find(p => !solvedPuzzles.includes(p.id));
                if (!unsolvedPuzzle) {
                    alert('ì´ê³³ì˜ ëª¨ë“  ë‹¨ì„œë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤.');
                    return;
                }
                const userAnswer = getValidatedInput(unsolvedPuzzle.puzzle, unsolvedPuzzle.validation);
                if (userAnswer === null) return;

                if (userAnswer.toLowerCase().trim() === unsolvedPuzzle.answer.toLowerCase().trim()) {
                    handlePuzzleSolved(unsolvedPuzzle);
                    updateEraClueButtonState();
                } else {
                    handleWrongAnswer();
                }
            };

            const checkPassword = () => {
                const room = gameData[currentRoomIndex];
                if (passwordInput.value.trim() === room.password) {
                    if (currentRoomIndex < gameData.length - 1) {
                        alert('ì •ë‹µ! ë‹¤ìŒ ë°©ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.');
                        transitionToNextRoom();
                    } else {
                        endGame();
                    }
                } else {
                    alert('ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.');
                }
            };

            // --- ì´ˆê¸°í™” ë° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²° ---
            startButton.addEventListener('click', startGame);
            passwordSubmit.addEventListener('click', checkPassword);
            eraClueButton.addEventListener('click', handleEraClueClick);
            passwordInput.addEventListener('keyup', (event) => {
                if (event.key === 'Enter') checkPassword();
            });
            restartFromGameOverButton.addEventListener('click', () => {
                gameOverScreen.style.display = 'none';
                startScreen.style.display = 'flex';
            });

            updateBestRecordDisplay();
        });
    </script>

</body>
</html>